# TimeWalker: Echoes of the Past

**TimeWalker: Echoes of the Past**는 전 세계의 역사를 지도 탐험과 시대 여행을 통해 배우는 인터랙티브 교육 어드벤처 게임입니다.

## 🎮 프로젝트 개요
플레이어는 '타임 워커'가 되어 다양한 시대와 장소를 여행하며 역사적 사건을 체험하고, 인물들과 대화하며 숨겨진 이야기를 발견합니다.

## 🚀 주요 기능
- **인터랙티브 지도 탐험**: Flame 엔진을 활용한 몰입감 있는 지도 이동 및 탐험.
- **시대 여행 (Time Travel)**: 고대, 중세, 근대 등 다양한 역사적 시대로의 이동.
- **대화 시스템**: 역사적 인물들과의 상호작용 및 스토리 진행 (JSON 기반 스크립트).
- **교육적 콘텐츠**: 역사적 사실에 기반한 퀘스트, 백과사전, 퀴즈 제공.
- **상점 및 인벤토리**: 게임 내 재화로 아이템 구매 및 관리.
- **다국어 지원**: 한국어 및 영어 지원 (l10n).

## 🛠 기술 스택
- **Framework**: Flutter
- **Language**: Dart
- **State Management**: Riverpod
- **Game Engine**: Flame (지도 및 인터랙션 구현)
- **Local Storage**: Hive, Shared Preferences
- **Routing**: GoRouter
- **Localization**: flutter_localizations, intl

## 📂 폴더 구조
```
lib/
├── content/       # 게임 데이터 (캐릭터, 대화, 시대 정보)
├── core/          # 공통 유틸리티, 상수, 테마, 라우팅
├── data/          # 데이터 레이어 (저장소, 모델, JSON 데이터 소스)
├── domain/        # 비즈니스 로직 (엔티티, 유스케이스, 리포지토리 인터페이스)
├── game/          # Flame 게임 엔진 관련 코드
├── interactive/   # 상호작용 요소 (대화, 탐험, 지도)
├── l10n/          # 다국어 지원 (ARB 파일)
├── presentation/  # UI (화면, 위젯, 프로바이더)
└── main.dart      # 앱 진입점
tools/             # 데이터 파이프라인 및 유틸리티 스크립트
```

## 📦 설치 및 실행
1. 저장소 클론:
   ```bash
   git clone https://github.com/kaywalker91/TimeWalker.git
   ```
2. 의존성 설치:
   ```bash
   flutter pub get
   ```
3. 앱 실행:
   ```bash
   flutter run
   ```

## 🔄 최근 업데이트 (2025-12-23)

### 1. 오디오 시스템 구축
- **AudioService & AudioProvider**: BGM 및 SFX 재생을 위한 중앙 집중식 오디오 관리 시스템 구현.
- **라이프사이클 관리**: 앱 상태(백그라운드/포그라운드)에 따른 오디오 자동 일시정지 및 재개 기능 (`AppLifecycleManager`).
- **에셋 추가**: 배경음악(BGM) 및 효과음(SFX) 파일 추가 및 연동.

### 2. 콘텐츠 확장 (가야 연맹)
- **새로운 시나리오**: 가야 연맹(금관가야, 대가야) 관련 스토리 및 대화 스크립트 추가.
- **캐릭터 추가**: 김수로왕, 허황옥, 우륵 등 주요 역사적 인물 데이터 및 일러스트 추가.
- **장소 데이터**: 구지봉, 김해 왕궁 등 가야 관련 탐험 장소 업데이트.

### 3. 게임플레이 & 지도 시스템
- **Flame 기반 월드맵**: `WorldMapGame` 구조 개선, 플레이어 이동 및 위치 마커 상호작용 강화.
- **좌표 투영 (Map Projection)**: 실제 지도 좌표와 게임 내 좌표 간의 변환 로직 구현 (`MapProjection`).
- **UI 개선**: 메인 메뉴, 대화 화면, 시대 탐험, 백과사전, 퀴즈 화면 UI/UX 업데이트.

### 4. 기타

- **문서화**: 개발 계획(주차별), 캐릭터 이미지 프롬프트 등 기획 문서 추가.

- **데이터 파이프라인**: 데이터 생성 및 병합을 위한 Python 스크립트 도구 개선.



## 🔄 최근 업데이트 (2025-12-31)



### 1. UI/UX 전면 리팩토링

- **Presentation Layer 개선**: 메인 메뉴, 대화, 백과사전, 퀴즈, 상점 등 주요 화면의 UI/UX를 현대적인 디자인으로 개선.

- **공통 위젯 강화**: 재사용 가능한 공통 위젯 라이브러리 확장 (`lib/presentation/widgets/common/`).

- **테마 시스템**: 앱 전반의 일관된 디자인 언어 적용을 위한 테마 및 스타일 업데이트.



### 2. 콘텐츠 및 에셋 대규모 확장

- **캐릭터 일러스트**: 안중근, 허준, 장영실, 정조 등 다수의 역사적 인물 고해상도 일러스트 및 표정 바리에이션 추가.

- **배경 이미지**: 고구려 왕궁, 살수 대첩, 조선 시대 등 시대별/장소별 몰입감 있는 배경 이미지 추가.

- **데이터 업데이트**: 캐릭터, 대화, 백과사전, 퀴즈 관련 JSON 데이터 최신화 및 정합성 개선.



### 3. 신규 기능 및 시스템 강화

- **업적 시스템 (Achievement)**: 플레이어의 활동(퀴즈, 탐험 등)에 따른 업적 달성 및 보상 시스템 구현 (`AchievementService`).

- **상점 및 인벤토리**: 아이템 구매 로직 및 UI 개선, 상점 데이터 구조 고도화.

- **오디오 고도화**: 화면 전환 시 BGM의 자연스러운 연결 및 관리를 위한 `BgmMixin`, `BgmNavigatorObserver` 적용.

- **데이터 소스 최적화**: 성능 향상을 위한 정적 데이터 소스(`static datasources`) 구조 도입.



### 4. 기획 및 문서화

- **상세 기획안 추가**: 신라/백je/조선 시나리오, 퀴즈 확장, 업적 시스템, 캐릭터 이미지 생성 계획 등 상세 기획 문서 추가 (`docs/plans/`).

- **리팩토링 계획**: UI/UX 및 코드 구조 개선을 위한 리팩토링 로드맵 수립.



## 🔄 최근 업데이트 (2026-01-05)

### 1. 진행도/해금 기반 구조 정리
- **UserProgress 시드 정비**: 초기 해금 범위를 `UserProgressSeed.initial`로 통일하고 신규 유저 생성 경로에 적용.
- **Era/Region 기본 상태 잠금**: 시대/지역 기본 상태를 `locked`로 고정하고 해금은 진행도 기준으로만 판단.

### 2. 국가 해금 규칙/표기 개선
- **국가 잠금 로직 통일**: 국가 카드 해금 판정을 `UserProgress.unlockedCountryIds` 기준으로 일원화.
- **해금 조건 안내 문구 추가**: 국가 카드에 잠금 사유 문구 노출 (예: “삼국시대 30% 완료 시 해금”).
- **국가별 규칙 매핑**: 중국/일본/인도/몽골 등 세부 조건과 지역별 규칙 테이블 추가.

### 3. 해금 이벤트/지역 정합성 보완
- **ProgressionService 해금 이벤트 확장**: 국가 해금 이벤트 처리 및 UI 알림 반영.
- **아메리카 지역 ID 정리**: `americas`로 통일하고 기존 ID와의 호환 처리 추가.
